function M = find_M(P)
	M = zeros(5, 3, 3, 'like', P);
	M(:, 1, 1) = [0, 0, P(1, 2, 2)*P(2, 1, 2) - P(3, 3, 1) - P(1, 1, 2)*P(3, 1, 2) + P(3, 1, 2)*(P(1, 1, 2) - P(3, 2, 2)), P(1, 2, 2)*P(2, 1, 3) - P(3, 3, 2) + P(1, 2, 3)*P(2, 1, 2) - P(1, 1, 2)*P(3, 1, 3) - P(1, 1, 3)*P(3, 1, 2) + P(3, 1, 3)*(P(1, 1, 2) - P(3, 2, 2)) + P(3, 1, 2)*(P(1, 1, 3) - P(3, 2, 3)), P(1, 2, 3)*P(2, 1, 3) - P(3, 3, 3) - P(1, 1, 3)*P(3, 1, 3) + P(3, 1, 3)*(P(1, 1, 3) - P(3, 2, 3))]; % degree = 2

	M(:, 1, 2) = [0, 0, P(1, 3, 1) + P(1, 2, 2)*P(2, 2, 2) - P(1, 2, 2)*P(3, 1, 2) + P(3, 2, 2)*(P(1, 1, 2) - P(3, 2, 2)), P(1, 3, 2) + P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - P(1, 2, 2)*P(3, 1, 3) - P(1, 2, 3)*P(3, 1, 2) + P(3, 2, 3)*(P(1, 1, 2) - P(3, 2, 2)) + P(3, 2, 2)*(P(1, 1, 3) - P(3, 2, 3)), P(1, 3, 3) + P(1, 2, 3)*P(2, 2, 3) - P(1, 2, 3)*P(3, 1, 3) + P(3, 2, 3)*(P(1, 1, 3) - P(3, 2, 3))]; % degree = 2

	M(:, 1, 3) = [0, P(1, 2, 2)*P(2, 3, 1) - P(1, 3, 1)*P(3, 1, 2) + P(3, 3, 1)*(P(1, 1, 2) - P(3, 2, 2)), P(1, 2, 2)*P(2, 3, 2) + P(1, 2, 3)*P(2, 3, 1) - P(1, 3, 1)*P(3, 1, 3) - P(1, 3, 2)*P(3, 1, 2) + P(3, 3, 2)*(P(1, 1, 2) - P(3, 2, 2)) + P(3, 3, 1)*(P(1, 1, 3) - P(3, 2, 3)), P(1, 2, 2)*P(2, 3, 3) + P(1, 2, 3)*P(2, 3, 2) - P(1, 3, 2)*P(3, 1, 3) - P(1, 3, 3)*P(3, 1, 2) + P(3, 3, 3)*(P(1, 1, 2) - P(3, 2, 2)) + P(3, 3, 2)*(P(1, 1, 3) - P(3, 2, 3)), P(1, 2, 3)*P(2, 3, 3) - P(1, 3, 3)*P(3, 1, 3) + P(3, 3, 3)*(P(1, 1, 3) - P(3, 2, 3))]; % degree = 3

	M(:, 2, 1) = [0, 0, P(2, 1, 2)*P(3, 2, 2) - P(1, 1, 2)*P(2, 1, 2) - P(2, 3, 1) - P(3, 1, 2)*(P(2, 2, 2) - P(3, 1, 2)), P(2, 1, 2)*P(3, 2, 3) - P(1, 1, 2)*P(2, 1, 3) - P(1, 1, 3)*P(2, 1, 2) - P(2, 3, 2) + P(2, 1, 3)*P(3, 2, 2) - P(3, 1, 3)*(P(2, 2, 2) - P(3, 1, 2)) - P(3, 1, 2)*(P(2, 2, 3) - P(3, 1, 3)), P(2, 1, 3)*P(3, 2, 3) - P(1, 1, 3)*P(2, 1, 3) - P(2, 3, 3) - P(3, 1, 3)*(P(2, 2, 3) - P(3, 1, 3))]; % degree = 2

	M(:, 2, 2) = [0, 0, P(3, 3, 1) - P(1, 2, 2)*P(2, 1, 2) + P(2, 2, 2)*P(3, 2, 2) - P(3, 2, 2)*(P(2, 2, 2) - P(3, 1, 2)), P(3, 3, 2) - P(1, 2, 2)*P(2, 1, 3) - P(1, 2, 3)*P(2, 1, 2) + P(2, 2, 2)*P(3, 2, 3) + P(2, 2, 3)*P(3, 2, 2) - P(3, 2, 3)*(P(2, 2, 2) - P(3, 1, 2)) - P(3, 2, 2)*(P(2, 2, 3) - P(3, 1, 3)), P(3, 3, 3) - P(1, 2, 3)*P(2, 1, 3) + P(2, 2, 3)*P(3, 2, 3) - P(3, 2, 3)*(P(2, 2, 3) - P(3, 1, 3))]; % degree = 2

	M(:, 2, 3) = [0, P(2, 3, 1)*P(3, 2, 2) - P(1, 3, 1)*P(2, 1, 2) - P(3, 3, 1)*(P(2, 2, 2) - P(3, 1, 2)), P(2, 3, 1)*P(3, 2, 3) - P(1, 3, 2)*P(2, 1, 2) - P(1, 3, 1)*P(2, 1, 3) + P(2, 3, 2)*P(3, 2, 2) - P(3, 3, 2)*(P(2, 2, 2) - P(3, 1, 2)) - P(3, 3, 1)*(P(2, 2, 3) - P(3, 1, 3)), P(2, 3, 2)*P(3, 2, 3) - P(1, 3, 3)*P(2, 1, 2) - P(1, 3, 2)*P(2, 1, 3) + P(2, 3, 3)*P(3, 2, 2) - P(3, 3, 3)*(P(2, 2, 2) - P(3, 1, 2)) - P(3, 3, 2)*(P(2, 2, 3) - P(3, 1, 3)), P(2, 3, 3)*P(3, 2, 3) - P(1, 3, 3)*P(2, 1, 3) - P(3, 3, 3)*(P(2, 2, 3) - P(3, 1, 3))]; % degree = 3

	M(:, 3, 1) = [0, 2*P(3, 1, 2)*P(3, 3, 1) - P(1, 3, 1)*P(2, 1, 2) - P(1, 1, 2)*P(2, 3, 1) - P(1, 1, 2)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 1, 2)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(3, 1, 2)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)), 2*P(3, 1, 2)*P(3, 3, 2) - P(1, 1, 2)*P(2, 3, 2) - P(1, 1, 3)*P(2, 3, 1) - P(1, 3, 1)*P(2, 1, 3) - P(1, 3, 2)*P(2, 1, 2) - P(3, 1, 2)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) + 2*P(3, 1, 3)*P(3, 3, 1) - P(1, 1, 3)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 1, 3)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(1, 1, 2)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 1, 2)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 1, 3)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)), 2*P(3, 1, 2)*P(3, 3, 3) - P(1, 1, 2)*P(2, 3, 3) - P(1, 1, 3)*P(2, 3, 2) - P(1, 3, 2)*P(2, 1, 3) - P(1, 3, 3)*P(2, 1, 2) - P(3, 1, 3)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) + 2*P(3, 1, 3)*P(3, 3, 2) - P(1, 1, 2)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 1, 2)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(1, 1, 3)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 1, 3)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 1, 2)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3)), 2*P(3, 1, 3)*P(3, 3, 3) - P(1, 3, 3)*P(2, 1, 3) - P(1, 1, 3)*P(2, 3, 3) - P(1, 1, 3)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 1, 3)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(3, 1, 3)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3))]; % degree = 3

	M(:, 3, 2) = [0, 2*P(3, 2, 2)*P(3, 3, 1) - P(1, 3, 1)*P(2, 2, 2) - P(1, 2, 2)*P(2, 3, 1) - P(1, 2, 2)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 2, 2)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(3, 2, 2)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)), 2*P(3, 2, 2)*P(3, 3, 2) - P(1, 2, 2)*P(2, 3, 2) - P(1, 2, 3)*P(2, 3, 1) - P(1, 3, 1)*P(2, 2, 3) - P(1, 3, 2)*P(2, 2, 2) - P(3, 2, 2)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) + 2*P(3, 2, 3)*P(3, 3, 1) - P(1, 2, 3)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 2, 3)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(1, 2, 2)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 2, 2)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 2, 3)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)), 2*P(3, 2, 2)*P(3, 3, 3) - P(1, 2, 2)*P(2, 3, 3) - P(1, 2, 3)*P(2, 3, 2) - P(1, 3, 2)*P(2, 2, 3) - P(1, 3, 3)*P(2, 2, 2) - P(3, 2, 3)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) + 2*P(3, 2, 3)*P(3, 3, 2) - P(1, 2, 2)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 2, 2)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(1, 2, 3)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 2, 3)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 2, 2)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3)), 2*P(3, 2, 3)*P(3, 3, 3) - P(1, 3, 3)*P(2, 2, 3) - P(1, 2, 3)*P(2, 3, 3) - P(1, 2, 3)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 2, 3)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(3, 2, 3)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3))]; % degree = 3

	M(:, 3, 3) = [P(3, 3, 1)^2 - P(1, 3, 1)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 3, 1)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(3, 3, 1)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)) - P(1, 3, 1)*P(2, 3, 1), 2*P(3, 3, 1)*P(3, 3, 2) - P(1, 3, 1)*P(2, 3, 2) - P(1, 3, 2)*P(2, 3, 1) - P(3, 3, 1)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) - P(1, 3, 2)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(2, 3, 2)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(1, 3, 1)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 3, 1)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 3, 2)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)), 2*P(3, 3, 1)*P(3, 3, 3) - P(1, 3, 1)*P(2, 3, 3) - P(1, 3, 2)*P(2, 3, 2) - P(1, 3, 3)*P(2, 3, 1) - P(3, 3, 2)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) - P(1, 3, 3)*(P(1, 1, 2)*P(2, 1, 2) - P(3, 1, 2)^2) - P(1, 3, 1)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 3, 3)*(P(1, 2, 2)*P(2, 2, 2) - P(3, 2, 2)^2) - P(2, 3, 1)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(1, 3, 2)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 3, 2)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 3, 3)*(P(1, 1, 2)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 2)) - P(3, 3, 1)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3)) + P(3, 3, 2)^2, 2*P(3, 3, 2)*P(3, 3, 3) - P(1, 3, 2)*P(2, 3, 3) - P(1, 3, 3)*P(2, 3, 2) - P(3, 3, 3)*(P(1, 1, 2)*P(2, 2, 3) + P(1, 1, 3)*P(2, 2, 2) + P(1, 2, 2)*P(2, 1, 3) + P(1, 2, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 2, 3) - 2*P(3, 1, 3)*P(3, 2, 2)) - P(1, 3, 2)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 3, 2)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(1, 3, 3)*(P(1, 1, 2)*P(2, 1, 3) + P(1, 1, 3)*P(2, 1, 2) - 2*P(3, 1, 2)*P(3, 1, 3)) - P(2, 3, 3)*(P(1, 2, 2)*P(2, 2, 3) + P(1, 2, 3)*P(2, 2, 2) - 2*P(3, 2, 2)*P(3, 2, 3)) - P(3, 3, 2)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3)), P(3, 3, 3)^2 - P(1, 3, 3)*(P(1, 1, 3)*P(2, 1, 3) - P(3, 1, 3)^2) - P(2, 3, 3)*(P(1, 2, 3)*P(2, 2, 3) - P(3, 2, 3)^2) - P(3, 3, 3)*(P(1, 1, 3)*P(2, 2, 3) + P(1, 2, 3)*P(2, 1, 3) - 2*P(3, 1, 3)*P(3, 2, 3)) - P(1, 3, 3)*P(2, 3, 3)]; % degree = 4

end